<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surprise! ‚Äî Happy Birthday üéâ</title>
  <style>
    :root{
      --bg1:#061226; --bg2:#0b1630; --accent:#ff6b81; --accent2:#ffd166; --glass: rgba(255,255,255,0.04);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#fff;overflow:hidden}

    /* Stage */
    .stage{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{width:100%;max-width:1050px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:24px;box-shadow:0 14px 60px rgba(2,6,23,0.7);position:relative;overflow:visible}

    /* header */
    .top{display:flex;gap:20px;align-items:center}
    .photo{width:150px;height:150px;border-radius:16px;overflow:hidden;flex:0 0 150px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;border:4px solid rgba(255,255,255,0.06)}
    .photo img{width:100%;height:100%;object-fit:cover;display:block}
    .info{flex:1}
    h1{margin:0;font-size:30px}
    .sub{opacity:0.9;margin-top:6px}

    /* big celebration area */
    .celebrate-area{margin-top:18px;display:flex;gap:20px;align-items:flex-start}
    .left{flex:1}
    .right{width:320px}

    /* cake */
    .cake-wrap{display:flex;align-items:center;justify-content:center;padding:18px}
    .cake{width:280px;height:180px;position:relative}
    .cake .layer{position:absolute;left:50%;transform:translateX(-50%);background:#fff;border-radius:8px}
    .cake .layer.bottom{width:260px;height:90px;bottom:0;background:#ffd9e1}
    .cake .layer.top{width:220px;height:70px;bottom:60px;background:#fff0}
    .candle{position:absolute;left:50%;transform:translateX(-50%);bottom:140px;display:flex;gap:8px}
    .candle span{width:8px;height:28px;background:#ffd166;border-radius:3px;display:block;position:relative}
    .flame{position:absolute;top:-10px;left:50%;transform:translateX(-50%);width:12px;height:18px;border-radius:50% 50% 50% 50%;background:linear-gradient(180deg,#ffd166,#ff6b81);filter:blur(0.6px);animation:flicker 400ms infinite}
    @keyframes flicker{0%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.12)}100%{transform:translateX(-50%) scale(0.98)}}

    /* party poppers */
    .popper{position:absolute;bottom:12px;left:12px;width:36px;height:36px;border-radius:6px;background:linear-gradient(90deg,#ff9ccf,#ffd166);display:flex;align-items:center;justify-content:center;transform-origin:center}
    .popper.right{right:12px;left:auto;background:linear-gradient(90deg,#6be3ff,#c88bff)}
    @keyframes pop{0%{transform:scale(0.8) rotate(-10deg)}50%{transform:scale(1.1) rotate(6deg)}100%{transform:scale(1) rotate(0deg)}}

    /* notes and controls */
    .controls{background:var(--glass);padding:12px;border-radius:12px;margin-top:8px}
    input[type=text]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}

    /* full-screen fireworks canvas */
    #fireworksCanvas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:12}

    /* confetti pieces */
    .confetti-piece{position:absolute;width:10px;height:14px;opacity:0.95;transform-origin:center;will-change:transform,opacity}

    /* surprise overlay */
    .surprise{position:fixed;inset:0;background:radial-gradient(circle at 30% 20%, rgba(255,107,129,0.12), transparent 20%), rgba(2,6,23,0.55);display:flex;align-items:center;justify-content:center;z-index:20}
    .surprise-card{background:linear-gradient(180deg,#0b1228,#071020);padding:22px;border-radius:14px;text-align:center;box-shadow:0 20px 60px rgba(2,6,23,0.7)}
    .surprise-card h2{margin:0 0 6px;font-size:28px}
    .surprise-card p{margin:0 0 12px;opacity:0.9}
    .hidden{display:none}

    /* responsive */
    @media (max-width:880px){.right{display:none}.photo{display:none}.cake{width:220px;height:150px}}
  </style>
</head>
<body>
  <canvas id="fireworksCanvas"></canvas>
  <div class="stage">
    <div class="card" id="card">
      <div style="display:flex;gap:18px;align-items:center">
        <label class="photo" id="photoLabel" title="Click to change photo">
          <img id="profilePhoto" src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=800&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder" alt="Your photo" />
        </label>
        <div class="info">
          <h1 id="greeting">Happy Birthday, <span id="herName">Her Name</span>! üéâ</h1>
          <div class="sub">Open the page and enjoy üéÇ fireworks, poppers and confetti ‚Äî made with love.</div>
        </div>
        <input type="file" id="photoInput" accept="image/*">
      </div>

      <div class="celebrate-area">
        <div class="left">
          <div class="cake-wrap">
            <div class="cake" id="cake">
              <div class="layer bottom"></div>
              <div class="layer top"></div>
              <div class="candle" id="candles">
                <span><i class="flame"></i></span>
                <span><i class="flame"></i></span>
                <span><i class="flame"></i></span>
              </div>
            </div>
          </div>
          <div style="text-align:center;margin-top:6px;font-weight:600" id="cakeText">Make a wish...</div>
        </div>

        <div class="right">
          <div class="controls">
            <h3 style="margin:0 0 8px">Personalise</h3>
            <input type="text" id="nameInput" placeholder="Type her name and press Set" />
            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="btn" id="setName">Set</button>
              <button class="btn ghost" id="surpriseAgain">Replay Surprise</button>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:14px;display:flex;gap:12px;align-items:center;position:relative">
        <div class="popper" id="popL">POP</div>
        <div style="flex:1;opacity:0.9">Here are some special notes for you ‚ù§Ô∏è</div>
        <div class="popper right" id="popR">üéâ</div>
      </div>

      <!-- Pre-written Notes -->
      <div id="notesSection">
        <div class="controls">
          <strong>You make my world brighter every day ‚ù§Ô∏è</strong><br><small>‚Äî From You</small>
        </div>
        <div class="controls">
          <strong>Thank you for being my best friend and partner üíï</strong><br><small>‚Äî From You</small>
        </div>
        <div class="controls">
          <strong>Happy Birthday! May all your dreams come true üéÇ‚ú®</strong><br><small>‚Äî From You</small>
        </div>
      </div>

    </div>
  </div>

  <!-- Surprise overlay -->
  <div class="surprise" id="surpriseOverlay">
    <div class="surprise-card">
      <h2>Surprise! üéÇ</h2>
      <p id="overlayText">Tap to Reveal ‚Äî or the celebration will start automatically.</p>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
        <button class="btn" id="revealBtn">Open Surprise</button>
        <button class="btn ghost" id="dismissBtn">Skip</button>
      </div>
    </div>
  </div>

  <script>
    const photoInput = document.getElementById('photoInput');
    const profilePhoto = document.getElementById('profilePhoto');
    const photoLabel = document.getElementById('photoLabel');
    const herName = document.getElementById('herName');
    const cakeText = document.getElementById('cakeText');
    const nameInput = document.getElementById('nameInput');
    const setNameBtn = document.getElementById('setName');
    const surpriseOverlay = document.getElementById('surpriseOverlay');
    const revealBtn = document.getElementById('revealBtn');
    const dismissBtn = document.getElementById('dismissBtn');
    const popL = document.getElementById('popL');
    const popR = document.getElementById('popR');

    // image change
    photoLabel.addEventListener('click',()=>photoInput.click())
    photoInput.addEventListener('change',(e)=>{
      const file = e.target.files[0]; if(!file) return; profilePhoto.src = URL.createObjectURL(file);
    })

    // set name
    setNameBtn.addEventListener('click',()=>{
      const v = nameInput.value.trim(); if(!v) return alert('Type a name'); 
      herName.textContent = v; 
      cakeText.textContent = 'Happy Birthday, ' + v + '!'; 
      nameInput.value='';
    })

    // popper animation
    function animatePoppers(){
      [popL,popR].forEach((p)=>{ p.style.animation='pop 550ms cubic-bezier(.2,.9,.3,1)'; setTimeout(()=>p.style.animation='',700); })
    }

    // confetti
    function makeConfetti(){
      const colors = ['#ff6b81','#ffd166','#6be3ff','#c88bff','#ffd1e6','#7cffb2'];
      const container = document.querySelector('.card');
      for(let i=0;i<50;i++){
        const el = document.createElement('div'); el.className='confetti-piece';
        el.style.left = (10 + Math.random()*80)+'%'; el.style.top = (5 + Math.random()*50)+'%';
        el.style.background = colors[Math.floor(Math.random()*colors.length)];
        el.style.position = 'absolute'; container.appendChild(el);
        requestAnimationFrame(()=>{ el.style.transition='transform 2.6s ease-in, top 2.8s ease-in, opacity 2.6s linear'; el.style.transform = `translateY(${300 + Math.random()*300}px) rotate(${Math.random()*720}deg)`; el.style.opacity = 0; });
        setTimeout(()=>el.remove(),3200);
      }
    }

    // Fireworks
    const canvas = document.getElementById('fireworksCanvas');
    const ctx = canvas.getContext('2d'); let cw, ch; function resize(){cw = canvas.width = innerWidth; ch = canvas.height = innerHeight;} resize(); addEventListener('resize', resize);
    class Particle{constructor(x,y,vx,vy,life,color){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.life=life;this.color=color;} update(dt){this.x+=this.vx*dt;this.y+=this.vy*dt;this.vy+=80*dt;this.life-=dt;} draw(ctx){ctx.globalAlpha=Math.max(0,this.life/1.6);ctx.fillStyle=this.color;ctx.beginPath();ctx.arc(this.x,this.y,Math.max(1,2*this.life),0,Math.PI*2);ctx.fill();}}
    let parts=[]; 
    function spawnFirework(x,y){const hue=Math.floor(Math.random()*360); for(let i=0;i<80;i++){const angle=Math.random()*Math.PI*2; const speed=40+Math.random()*220; const vx=Math.cos(angle)*speed; const vy=Math.sin(angle)*speed; const color=`hsl(${hue + (Math.random()*40-20)},90%,60%)`; parts.push(new Particle(x,y,vx,vy,1+Math.random()*1.2,color));}}
    let last=performance.now(); function loop(now){const dt=Math.min(0.04,(now-last)/1000); last=now; ctx.clearRect(0,0,cw,ch); for(let i=parts.length-1;i>=0;i--){parts[i].update(dt);parts[i].draw(ctx);if(parts[i].life<=0) parts.splice(i,1);} requestAnimationFrame(loop);} requestAnimationFrame(loop);

    function startSurprise(){
      surpriseOverlay.classList.add('hidden');
      animatePoppers(); makeConfetti();
      const positions=[{x:cw*0.25,y:ch*0.25},{x:cw*0.5,y:ch*0.2},{x:cw*0.75,y:ch*0.3},{x:cw*0.5,y:ch*0.5}];
      positions.forEach((p,i)=> setTimeout(()=>spawnFirework(p.x,p.y), i*400));
      const seq=[800,1200,1600,2100,2800]; seq.forEach((t)=> setTimeout(()=>spawnFirework(Math.random()*cw, Math.random()*ch*0.6 + 50), t));
      setTimeout(()=>makeConfetti(),900);
    }

    let autoStartTimer=setTimeout(()=>{if(!surpriseOverlay.classList.contains('hidden')) startSurprise();},1200);
    revealBtn.addEventListener('click',()=>{clearTimeout(autoStartTimer);startSurprise();});
    dismissBtn.addEventListener('click',()=>{clearTimeout(autoStartTimer);surpriseOverlay.classList.add('hidden');});
    document.getElementById('surpriseAgain').addEventListener('click',()=>{startSurprise();});
    nameInput.addEventListener('keydown',(e)=>{if(e.key==='Enter'){setNameBtn.click();}});
    (function(){try{const params=new URLSearchParams(location.search);const n=params.get('name');if(n){herName.textContent=n;cakeText.textContent='Happy Birthday, '+n+'!';}}catch(e){}})();
    surpriseOverlay.addEventListener('click',(e)=>{if(e.target===surpriseOverlay){revealBtn.click();}});
  </script>
</body>
</html>
